# ===============================================
# 1. CORE SERVICE CREDENTIALS (RABBITMQ, POSTGRES, MINIO)
# Used by the core services themselves and referenced by application services (api-edtech, etc.)
# ===============================================
# PostgreSQL
POSTGRES_DB=postgres
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres_secure_pass

# Minio
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin_secure_pass
MINIO_PORT=9000
MINIO_URL=minio:9000
MINIO_API_URL=http://minio:9000

# RabbitMQ
RABBITMQ_DEFAULT_USER=rabbitmq_user
RABBITMQ_DEFAULT_PASS=rabbitmq_secure_pass

# ===============================================
# 2. PORT MAPPINGS & HOSTS
# Used for external access or internal service configuration
# ===============================================
API_PORT=8000
AGENTIC_RAG_PORT=8002
TRANSCODE_WORKER_PORT=8089

# Janus
DOCKER_IP=127.0.0.1
JANUS_PORT=8088

# Base URLs
BASE_URL=http://localhost:5173
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173

# ===============================================
# 3. API-EDTECH (Spring Boot) CONFIGURATION
# All values required by the 'api-edtech' environment block
# ===============================================
# Server & Flyway
SERVER_SERVLET_CONTEXT_PATH=/api/v1
SPRING_DATASOURCE_DRIVER_CLASS_NAME=org.postgresql.Driver
SPRING_FLYWAY_ENABLED=true
SPRING_FLYWAY_BASELINE_ON_MIGRATE=true
SPRING_FLYWAY_LOCATIONS=classpath:db/migration
SPRING_FLYWAY_SCHEMAS=public
SPRINGDOC_OVERRIDE_WITH_GENERIC_RESPONSE=false
SPRING_SERVLET_MULTIPART_MAX_FILE_SIZE=2GB
SPRING_SERVLET_MULTIPART_MAX_REQUEST_SIZE=2GB

# JWT
JWT_SECRET=eW91ci1uZXctc3VwZXItbG9uZy1hbmQtc2VjdXJlLWJhc2U2NC1lbmNvZGVkLXNlY3JldC1rZXktZ29lcy1oZXJl # <--- KEEP THIS LONG AND SECRET
JWT_EXPIRATION_MS=30000000
JWT_REFRESH_EXPIRATION_MS=3000000000

# Mailer (WARNING: Highly sensitive, use an App Password)
SPRING_MAIL_HOST=smtp.gmail.com
SPRING_MAIL_PORT=587
SPRING_MAIL_USERNAME=
SPRING_MAIL_PASSWORD=
SPRING_MAIL_PROPERTIES_MAIL_SMTP_AUTH=true
SPRING_MAIL_PROPERTIES_MAIL_SMTP_STARTTLS_ENABLE=true

# Minio (Bucket Name)
MINIO_BUCKET_NAME=edtech-content

# Janus/RAG External URLs (Internal hostnames used, but ports are variable)
JANUS_SERVER_URL=http://janus:${JANUS_PORT}/janus
RAG_API_URL=http://agentic-rag:${AGENTIC_RAG_PORT}


# ===============================================
# 4. AGENTIC-RAG CONFIGURATION
# All values required by the 'agentic-rag' environment block
# ===============================================
# AI/Tracing (Set your API keys here)
DEEPSEEK_API_KEY=your_deepseek_api_key
TAVILY_API_KEY=your_tavily_api_key
LANGCHAIN_API_KEY=your_langchain_api_key
LANGCHAIN_TRACING_V2=false
LANGCHAIN_PROJECT=agentic-rag
DEEPSEEK_RATE_LIMIT_PER_MINUTE=100

# RAG Database Connection (Internal to RAG)
RAG_DB_CONNECT_TIMEOUT=10

# Chroma/RAG Config
CHROMA_COLLECTION_NAME=rag-edtech
CHROMA_PERSIST_DIR=/app/.chroma
RAG_CHUNK_SIZE=700
RAG_CHUNK_OVERLAP=120
KNOWLEDGE_BASE_DIR=/app/knowledge-base
USER_AGENT=agentic-rag/0.1 (docker)

# ===============================================
# 5. TRANSCODE-VIDEO-WORKER CONFIGURATION
# All values required by the 'transcode-video-worker' environment block
# ===============================================
# Worker App Details
APP_ENVIRONMENT=development
APP_HOST=localhost:12000
APP_PROTOCOL=http
WORKER_SERVER_PORT=8080 # Renamed variable for clarity (was SERVER_PORT in my previous suggestion)
SERVER_WORKERS=5

# Worker's RabbitMQ/Minio Credentials (Note: These often match the defaults above)
RABBITMQ_HOST=rabbitmq
RABBITMQ_PORT=5672
RABBITMQ_USER=guest # Uses the default user from section 1
RABBITMQ_PASS=guest # Uses the default pass from section 1
RABBITMQ_KIND=topic
RABBITMQ_EXCHANGE_NAME=transcoding_exchange
RABBITMQ_QUEUE_NAME=transcoding_queue
RABBITMQ_ROUTING_KEY=video.transcoding.request

# Recording Merge
RABBITMQ_RECORDING_MERGE_QUEUE_NAME=recording_merge_queue
RABBITMQ_RECORDING_MERGE_ROUTING_KEY=recording.merge.request
RABBITMQ_RECORDING_MERGE_DLQ_ROUTING_KEY=dlq.recording.merge.request

# Dead Letter Exchange (DLX) & Dead Letter Queue (DLQ)
RABBITMQ_DLX_NAME=transcoding_exchange_dlx
RABBITMQ_DLQ_NAME=transcoding_queue_dlq
RABBITMQ_DLQ_ROUTING_KEY=dlq.video.transcoding.request

# Transcription
RABBITMQ_TRANSCRIPTION_QUEUE_NAME=transcription_queue
RABBITMQ_TRANSCRIPTION_DLX_NAME=transcription_exchange_dlx
RABBITMQ_TRANSCRIPTION_DLQ_NAME=transcription_queue_dlq
RABBITMQ_TRANSCRIPTION_DLQ_ROUTING_KEY=dlq.video.transcoding.request

MINIO_ACCESS_ID=${MINIO_ROOT_USER}      # Uses the Minio root user from section 1
MINIO_SECRET_ACCESS_KEY=${MINIO_ROOT_PASSWORD} # Uses the Minio root pass from section 1
MINIO_BUCKET=edtech-content

# PostgreSQL Connection (The worker may use the shared service names/credentials)
DB_HOST=db
DB_PORT=5432

#Cloudfare config
CF_API_EMAIL=
CF_DNS_API_TOKEN=